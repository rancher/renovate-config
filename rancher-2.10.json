{
  "$schema": "https://docs.renovatebot.com/renovate-schema.json",
  "extends": ["{{#if env.RENOVATE_EXTENDS_PRESET}}{{env.RENOVATE_EXTENDS_PRESET}}{{else}}github>rancher/renovate-config#release{{/if}}"],
  "vulnerabilityAlerts": { "enabled": true },
  "packageRules": [
    {
      "matchUpdateTypes": ["major","minor","patch","pin","digest","pinDigest"],
      "enabled": false
    },
    {
      "description": "Enable updates for packages with known vulnerabilities",
      "matchJsonata": ["$exists(vulnerabilityFixVersion)"],
      "enabled": true
    },
    {
      "description": "Disable vulnerability updates for test/dev dependencies",
      "matchDepTypes": ["devDependencies", "dev-dependencies", "test"],
      "matchJsonata": ["$exists(vulnerabilityFixVersion)"],
      "enabled": false
    },
    {
      "description": "Enable patch updates for Go packages",
      "matchPackageNames": [
        "golang",
        "go",
        "registry.suse.com/bci/golang",
        "registry.opensuse.org/opensuse/bci/golang"
      ],
      "matchUpdateTypes": ["patch"],
      "enabled": true
    },
    {
      "description": "Restrict Go versions to below 1.25.0",
      "matchPackageNames": [
        "golang",
        "go",
        "registry.suse.com/bci/golang",
        "registry.opensuse.org/opensuse/bci/golang"
      ],
      "allowedVersions": "<1.25.0"
    },
    {
      "description": "Enable patch updates for golang-version datasource",
      "matchDatasources": ["golang-version"],
      "matchUpdateTypes": ["patch"],
      "enabled": true
    },
    {
      "description": "Restrict golang-version to below 1.25.0",
      "matchDatasources": ["golang-version"],
      "allowedVersions": "<1.25.0"
    },
    {
      "description": "Enable and restrict kubectl to below 1.32.0",
      "matchManagers": ["gomod", "custom.regex", "dockerfile"],
      "matchPackageNames": ["rancher/kubectl"],
      "allowedVersions": "<1.32.0",
      "enabled": true
    },
    {
      "description": "Enable and restrict kubernetes/kubernetes and k8s.io/kubernetes to below 1.32.0",
      "matchManagers": ["gomod"],
      "matchPackageNames": ["kubernetes/kubernetes", "k8s.io/kubernetes"],
      "allowedVersions": "<1.32.0",
      "enabled": true
    },
    {
      "description": "Enable and restrict k8s.io dependencies (excluding k8s.io/kubernetes) to below 0.32.0",
      "matchManagers": ["gomod"],
      "matchPackageNames": ["!k8s.io/kubernetes", "k8s.io/**"],
      "allowedVersions": "<0.32.0",
      "enabled": true
    },
    {
      "description": "Disable major bumps",
      "matchPackageNames": ["rancher/kuberlr-kubectl"],
      "matchUpdateTypes": ["minor","patch"],
      "enabled": true
    },
    {
      "description": "Disable vulnerability alerts for all k8s and golang modules to prevent non-patch level bumps",
      "matchPackageNames": [
        "golang",
        "go",
        "registry.suse.com/bci/golang",
        "registry.opensuse.org/opensuse/bci/golang",
        "rancher/kubectl",
        "kubernetes/kubernetes",
        "k8s.io/**"
      ],
      "vulnerabilityAlerts": { "enabled": false }
    }
  ]
}
