{
  "$schema": "https://docs.renovatebot.com/renovate-schema.json",
  "extends": ["{{#if env.RENOVATE_EXTENDS_PRESET}}{{env.RENOVATE_EXTENDS_PRESET}}{{else}}github>rancher/renovate-config#release{{/if}}"],
  "vulnerabilityAlerts": { "enabled": true },
  "packageRules": [
    {
      "matchUpdateTypes": ["major","minor","patch","pin","digest","pinDigest"],
      "enabled": false
    },
    {
      "description": "Enable updates for packages with known vulnerabilities (except Go/K8s/test deps)",
      "matchPackageNames": [
        "!golang",
        "!go",
        "!registry.suse.com/bci/golang",
        "!registry.opensuse.org/opensuse/bci/golang",
        "!rancher/kubectl",
        "!kubernetes/kubernetes",
        "!k8s.io/kubernetes",
        "!k8s.io/**"
      ],
      "matchDepTypes": ["!devDependencies", "!dev-dependencies", "!test"],
      "matchJsonata": ["$exists(vulnerabilityFixVersion)"],
      "enabled": true
    },
    {
      "description": "Enable patch updates for Go packages",
      "matchPackageNames": [
        "golang",
        "go",
        "registry.suse.com/bci/golang",
        "registry.opensuse.org/opensuse/bci/golang"
      ],
      "allowedVersions": "<1.24",
      "enabled": true
    },
    {
      "description": "Enable patch updates for golang-version datasource",
      "matchDatasources": ["golang-version"],
      "allowedVersions": "<1.24",
      "enabled": true
    },
    {
      "description": "Enable patch updates for kubectl",
      "matchManagers": ["gomod", "custom.regex", "dockerfile"],
      "matchPackageNames": ["rancher/kubectl"],
      "allowedVersions": "<1.31",
      "enabled": true
    },
    {
      "description": "Enable patch updates for kubernetes/kubernetes and k8s.io/kubernetes",
      "matchManagers": ["gomod"],
      "matchPackageNames": ["kubernetes/kubernetes", "k8s.io/kubernetes"],
      "allowedVersions": "<1.31",
      "enabled": true,
      "groupName": "Kubernetes dependencies",
      "commitMessageTopic": "Kubernetes dependencies",
      "commitMessageExtra": "to {{#if isSingleVersion}}{{newVersion}}{{else}}{{newValue}}{{/if}}"
    },
    {
      "description": "Enable patch updates for k8s.io dependencies",
      "matchManagers": ["gomod"],
      "matchPackageNames": [
        "!k8s.io/kubernetes",
        "!k8s.io/gengo",
        "!k8s.io/gengo/**",
        "!k8s.io/utils",
        "!k8s.io/utils/**",
        "!k8s.io/kube-openapi",
        "!k8s.io/kube-openapi/**",
        "k8s.io/**"
      ],
      "allowedVersions": "<0.31",
      "enabled": true,
      "groupName": "Kubernetes dependencies",
      "commitMessageTopic": "Kubernetes dependencies",
      "commitMessageExtra": "to {{#if isSingleVersion}}{{newVersion}}{{else}}{{newValue}}{{/if}}"
    },
    {
      "description": "Enable minor and patch updates for rancher/kuberlr-kubectl",
      "matchPackageNames": ["rancher/kuberlr-kubectl"],
      "matchUpdateTypes": ["minor","patch"],
      "enabled": true
    }
  ]
}
