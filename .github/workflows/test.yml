name: Tests

on:
  push:
  pull_request:

permissions:
  contents: read

jobs:
  validate:
    runs-on: ubuntu-latest
    steps:
    - name: Checkout code
      uses: actions/checkout@08c6903cd8c0fde910a37f88322edcfb5dd907a8 # v5

    - run: make validate

  call-workflow:
    permissions:
      contents: read
      id-token: write

    uses: ./.github/workflows/renovate-vault.yml
    with:
      configMigration: 'true'
      logLevel: 'debug'
      overrideSchedule: "{'schedule':null}'"
      renovateConfig: ${{ inputs.renovateConfig || '.github/renovate.json' }}
      dryRun: 'full'
