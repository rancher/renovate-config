name: Tests

on:
  push:
  pull_request:

permissions:
  contents: read

jobs:
  validate:
    runs-on: ubuntu-latest
    steps:
    - name: Checkout code
      uses: actions/checkout@8e8c483db84b4bee98b60c0593521ed34d9990e8 # v6

    - run: make validate

  call-workflow:
    permissions:
      contents: read
      id-token: write

    uses: ./.github/workflows/renovate-vault.yml
    with:
      configMigration: 'true'
      logLevel: 'debug'
      overrideSchedule: "{'schedule':null}'"
      renovateConfig: ${{ inputs.renovateConfig || '.github/renovate.json' }}
      dryRun: 'full'
